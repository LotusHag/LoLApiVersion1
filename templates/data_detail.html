<!-- templates/data_detail.html -->

{% extends 'base.html' %}

{% block content %}
<h2>{{ data_type.capitalize() }} Detail</h2>
{% if data_type == 'matches' %}
  <p><strong>Match:</strong> 
    <a href="{{ url_for('data_detail', data_type='teams', object_id=detail['teams'][0]['_id']) }}">
      {{ detail['teams'][0]['team_name'] }}
    </a> vs 
    <a href="{{ url_for('data_detail', data_type='teams', object_id=detail['teams'][1]['_id']) }}">
      {{ detail['teams'][1]['team_name'] }}
    </a>
  </p>
  <p><strong>Date:</strong> {{ detail['date'] }}</p>
  <p><strong>Division:</strong> {{ detail['division'] }} | <strong>Split:</strong> {{ detail['split'] }}</p>
  <p><strong>Winner:</strong> 
    <a href="{{ url_for('data_detail', data_type='teams', object_id=(detail['teams'][0]['_id'] if detail['teams'][0]['win'] else detail['teams'][1]['_id'])) }}">
      {{ detail['teams'][0]['team_name'] if detail['teams'][0]['win'] else detail['teams'][1]['team_name'] }}
    </a>
  </p>
  
  <div class="team-container">
    <div class="team blue-team">
      <h3>{{ detail['teams'][0]['team_name'] }} (Blue Side)</h3>
      <div class="player-list">
        {% for player in detail['players'] if player.team_id == 100 %}
        <div class="player">
          <div class="player-name">{{ player.summoner_name }}</div>
          <div class="champion">{{ player.champion }}</div>
          <div class="kda">{{ player.kda }}</div>
          <div class="damage">
            <div>Dealt: {{ player.damage_dealt }}</div>
            <div>Taken: {{ player.damage_taken }}</div>
          </div>
          <div class="gold-cs">
            <div>Gold: {{ player.gold_earned }}</div>
            <div>CS: {{ player.cs }}</div>
          </div>
          <div class="items">
            {% for item in player.items %}
            <img src="https://ddragon.leagueoflegends.com/cdn/latest/img/item/{{ item }}.png" alt="Item">
            {% endfor %}
          </div>
        </div>
        {% endfor %}
      </div>
    </div>

    <div class="team red-team">
      <h3>{{ detail['teams'][1]['team_name'] }} (Red Side)</h3>
      <div class="player-list">
        {% for player in detail['players'] if player.team_id == 200 %}
        <div class="player">
          <div class="player-name">{{ player.summoner_name }}</div>
          <div class="champion">{{ player.champion }}</div>
          <div class="kda">{{ player.kda }}</div>
          <div class="damage">
            <div>Dealt: {{ player.damage_dealt }}</div>
            <div>Taken: {{ player.damage_taken }}</div>
          </div>
          <div class="gold-cs">
            <div>Gold: {{ player.gold_earned }}</div>
            <div>CS: {{ player.cs }}</div>
          </div>
          <div class="items">
            {% for item in player.items %}
            <img src="https://ddragon.leagueoflegends.com/cdn/latest/img/item/{{ item }}.png" alt="Item">
            {% endfor %}
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>

{% elif data_type == 'players' %}
  <p><strong>Summoner Names:</strong> {{ detail['summoner_names'] | join(', ') }}</p>
  <p><strong>Current Teams:</strong></p>
  <ul>
    {% for team in detail['current_teams'] %}
    <li>
      <a href="{{ url_for('data_detail', data_type='teams', object_id=team['_id']) }}">
        {{ team['team_name'] }} ({{ team['division'] }} / {{ team['split'] }})
      </a>
    </li>
    {% endfor %}
  </ul>
  <p><strong>Match History:</strong></p>
  <ul>
    {% for match_id in detail['match_history'] %}
    <li>
      <a href="{{ url_for('data_detail', data_type='matches', object_id=match_id) }}">
        Match ID: {{ match_id }}
      </a>
    </li>
    {% endfor %}
  </ul>

{% elif data_type == 'teams' %}
  <p><strong>Team Name:</strong> {{ detail['team_name'] }}</p>
  <p><strong>Division:</strong> {{ detail['division'] }}</p>
  <p><strong>Split:</strong> {{ detail['split'] }}</p>
  <p><strong>Match History:</strong></p>
  <ul>
    {% for match_id in detail['match_history'] %}
    <li>
      <a href="{{ url_for('data_detail', data_type='matches', object_id=match_id) }}">
        Match ID: {{ match_id }}
      </a>
    </li>
    {% endfor %}
  </ul>
{% endif %}
{% endblock %}
